import {Route, IndexRedirect} from 'react-router';
import React from 'react';
import Admin from 'containers/addBooks'
import {getUserIsAdmin, getUserIsSignInState} from '../../node_modules/userSelector'
import Layout from "containers/layout/index";
import Book from "containers/book/index";


const requireAuth = (nextState, replace, cb) => {
    console.log("isAdmin? " + !getUserIsAdmin(store.getState()));
    if (getUserIsAdmin(store.getState())) {
        console.log("I am admin");
        replace({
            pathname: '/admin'
        });
    }
    cb();
}
export const isAdmin = () => {
    console.log("isAdmin? " + !getUserIsAdmin(store.getState()));
    getUserIsAdmin(store.getState());}

export const isSignIn = () => {
    console.log("isSignIn? " + !getUserIsAdmin(store.getState()));
    getUserIsSignInState(store.getState());}

function requireAlreadyAuth(nextState, replace, cb) {
    if (!getUserIsAdmin(store.getState())) {
        replace({
            pathname: '/'
        });
    }
    cb();
}

let store;

export default function routes(storeRef) {
    store = storeRef;
    return (
        <Route>
            <Route path='/admin' component={Admin} onEnter={requireAuth}/>
        </Route>
    );
}
